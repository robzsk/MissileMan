!function t(n,e,o){function r(a,c){if(!e[a]){if(!n[a]){var u="function"==typeof require&&require;if(!c&&u)return u(a,!0);if(i)return i(a,!0);var s=new Error("Cannot find module '"+a+"'");throw s.code="MODULE_NOT_FOUND",s}var f=e[a]={exports:{}};n[a][0].call(f.exports,function(t){var e=n[a][1][t];return r(e?e:t)},f,f.exports,t,n,e,o)}return e[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(t,n,e){!function(){"use strict";var n="level.json",e=t("./src/overlay"),o=t("./src/input"),r=t("./src/player"),i=t("./src/assets"),a=t("./src/world"),c=t("./src/loop"),u=[],s=[],f=0,l=o({keys:{left:37,right:39,jump:38}}),p=o({keys:{up:38,down:40,select:13}}),d=function(t){s=t.spawnPoints,_.each(t.targets,function(t){a.addTarget(t)}),a.addBlocks(t.cells)},y=function(t){var n=function(n){$.get(t,function(t){d(t.cells?t:JSON.parse(t)),n()})},e=function(){0===u.length&&(u[f]=r({input:l,pos:s[f]})),l.reset(),_.each(u,function(t){t.reset(),a.addPlayer(t,t===u[f])})};a.clear(),c.reset(),n(e)};$(a).on("world.player.killed",function(t,i){u[f]===i&&(u[f].detatchInput(),u[f]=r({input:o({replay:l.serialize()}),obj:s[f]}),f+=1,f>=s.length&&(f=0),u[f]&&u[f].detatchInput(),u[f]=r({input:l,obj:s[f]}),setTimeout(function(){a.isComplete()?e.showTitle(p):(e.fadeFromBlack(),y(n))},1e3))}),$(e).on("title.playbutton.click",function(){e.hideTitle(),e.fadeFromBlack(),_.each(u,function(t){t.detatchInput()}),u=[],f=0,y(n)}),$(document).ready(function(){i.load(),$(i).on("assets.loaded",function(){e.fadeFromBlack(),e.showTitle(p)})}),$(c).on("loop.update",function(t,n,e){p.update(n),a.update(n,e)}),$(c).on("loop.render",function(t,n){a.render(n)})}()},{"./src/assets":2,"./src/input":3,"./src/loop":4,"./src/overlay":5,"./src/player":10,"./src/world":12}],2:[function(t,n,e){"use strict";n.exports=function(){var t={},n=function(t){var n=new THREE.BoxGeometry(1,1,1),e=new THREE.MeshBasicMaterial({color:t}),o=new THREE.Mesh(n,e);return o};return{load:function(){var n=new THREE.LoadingManager,e=new THREE.JSONLoader(n),o=function(n,o,r){e.load("assets/"+o+".json",function(e){t[n]=new THREE.Mesh(e,void 0===r?new THREE.MeshDepthMaterial:new THREE.MeshBasicMaterial({color:r}))})},r=this;n.onLoad=function(){$(r).trigger("assets.loaded")},o("empty","empty"),o("solid","solid"),o("player","player",96725)},cubeEmpty:function(n){return t.empty.clone()},cubeSolid:function(){return t.solid.clone()},cubeTarget:function(){return n(11289666)},cubePlayer:function(){return t.player.clone()}}}()},{}],3:[function(t,n,e){"use strict";var o=function(t){var n=JSON.parse(t);return{update:function(t){var e=n["_"+t];e&&$(this).trigger("input.move",_.clone(e))}}},r=function(t){var n=_.mapObject(t,function(){return!1}),e=_.clone(n),o={},r=function(e,o,r){_.findKey(t,function(t,i){return t===o?(n[i]=r,e.preventDefault(),!0):void 0})};return $(document).keydown(function(t){return r(t,t.keyCode,!0)}),$(document).keyup(function(t){return r(t,t.keyCode,!1)}),{reset:function(){o={}},serialize:function(){return JSON.stringify(o)},update:function(t){_.isMatch(n,e)||(o["_"+t]=_.clone(n),$(this).trigger("input.move",_.clone(n)),_.extend(e,n))}}};n.exports=function(t){return t.replay?o(t.replay):r(t.keys)}},{}],4:[function(t,n,e){n.exports=function(){"use strict";var t,n,e=function(){var t={begin:function(){},end:function(){}};return"undefined"!=typeof Stats&&(t=new Stats,t.setMode(0),t.domElement.style.position="absolute",t.domElement.style.left="0px",t.domElement.style.top="0px",$("body").append(t.domElement)),t}(),o=function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()},r=1/60,i=0,a=o(),c=0;return+function u(){for(requestAnimationFrame(u),e.begin(),n=o(),i+=Math.min(1,(n-a)/1e3);i>r;)i-=r,$(t).trigger("loop.update",[c,r]),c+=1;$(t).trigger("loop.render",i),a=n,e.end()}(),t={reset:function(){c=0}}}()},{}],5:[function(t,n,e){n.exports=function(){"use strict";var t,n,e=function(){var t=$("<div/>").css({position:"fixed",backgroundColor:"black",height:"100%",width:"100%",margin:0,padding:0});return $("body").append(t),t}(),o=function(){var n=$("<button>").css({position:"fixed",bottom:"-100px",left:"50%"}).click(function(){$(t).trigger("title.playbutton.click")}).text("Play");return $("body").append(n),n}(),r=function(n,e){e.select&&$(t).trigger("title.playbutton.click")};return t={fadeFromBlack:function(){e.css({opacity:1}),e.stop().animate({opacity:0},600)},showTitle:function(t){o.stop().animate({bottom:"100px"},600,"easeOutBack"),n=t,$(n).on("input.move",r)},hideTitle:function(){o.stop().animate({bottom:"-100px"},400,"easeInBack"),$(n).off("input.move",r)}}}()},{}],6:[function(t,n,e){n.exports=function(){"use strict";var t=.425,n=Math.pow(t,2),e=new THREE.Euler,o=new THREE.Vector2(0,0),r=new THREE.Vector2(0,0),i=new THREE.Vector2,a=function(e){var i=new THREE.Vector2;i.copy(r).sub(e);var a=i.lengthSq();if(n>a){var c=t-Math.sqrt(a),u=i.normalize().multiplyScalar(c);r.add(u),o.sub(u)}},c=function(t,n){i.set(0,0),u.forces(e,i),i.multiplyScalar(t),o.add(i),u.limitVelocity(o),i.copy(o).multiplyScalar(t),r.add(i),_.each(n,function(t){a(t.nearestPoint(r))})},u={update:function(t,n,e){c(t,e)},forces:function(t,n){},limitVelocity:function(t){},setPosition:function(t,n){r.set(t,n,0)},position:function(){var t=new THREE.Vector3;return function(){return t.set(r.x,r.y,0)}}(),rotation:function(){var t=new THREE.Euler;return function(){return t.copy(e)}}()};return u}},{}],7:[function(t,n,e){var o=[];o.push([[],[{a:[1,1],b:[2,1]}],[{a:[0,1],b:[1,1]}],[{a:[0,1],b:[2,1]}],[{a:[-1,1],b:[0,1]}],[{a:[-1,1],b:[0,1]},{a:[1,1],b:[2,1]}],[{a:[-1,1],b:[1,1]}],[{a:[-1,1],b:[2,1]}]]),o.push([[],[{a:[1,0],b:[2,0]}],[{a:[0,0],b:[1,0]}],[{a:[0,0],b:[2,0]}],[{a:[-1,0],b:[0,0]}],[{a:[-1,0],b:[0,0]},{a:[1,0],b:[2,0]}],[{a:[-1,0],b:[1,0]}],[{a:[-1,0],b:[2,0]}]]),o.push([[],[{a:[0,1],b:[0,2]}],[{a:[0,0],b:[0,1]}],[{a:[0,0],b:[0,2]}],[{a:[0,-1],b:[0,0]}],[{a:[0,-1],b:[0,0]},{a:[0,1],b:[0,2]}],[{a:[0,-1],b:[0,1]}],[{a:[0,-1],b:[0,2]}]]),o.push([[],[{a:[1,1],b:[1,2]}],[{a:[1,0],b:[1,1]}],[{a:[1,0],b:[1,2]}],[{a:[1,-1],b:[1,0]}],[{a:[1,-1],b:[1,0]},{a:[1,1],b:[1,2]}],[{a:[1,-1],b:[1,1]}],[{a:[1,-1],b:[1,2]}]]),n.exports={createLine:function(t){var n={x:t.a[0],y:t.a[1],z:0},e={x:t.b[0],y:t.b[1],z:0},o=function(){var t=new THREE.Vector2;return t.subVectors(e,n)}(),r=function(){return o.lengthSq()}();return{p1:n,p2:e,nearestPoint:function(){var t=new THREE.Vector2,i=t.clone();return function(a){var c=t.subVectors(i.copy(a),n).dot(o);return 0>c?n:c>r?e:t.copy(o).multiplyScalar(c/r).add(n)}}()}},makeLines:function(t,n){switch(n){case"top":return o[0][t];case"bottom":return o[1][t];case"left":return o[2][t];case"right":return o[3][t]}return[]}}},{}],8:[function(t,n,e){var o=t("./line");n.exports=function(){"use strict";var t=[],n={tw:64,th:48},e=function(e,o){return t[e+o*n.tw]};return{clear:function(){t=[]},getLines:function(t){var n=Math.floor(t.position().x),r=Math.floor(t.position().y),i=[],a=0;a+=e(n-1,r-1)?4:0,a+=e(n,r-1)?2:0,a+=e(n+1,r-1)?1:0,i=i.concat(o.makeLines(a,"bottom")),a=0,a+=e(n-1,r+1)?4:0,a+=e(n,r+1)?2:0,a+=e(n+1,r+1)?1:0,i=i.concat(o.makeLines(a,"top")),a=0,a+=e(n-1,r-1)?4:0,a+=e(n-1,r)?2:0,a+=e(n-1,r+1)?1:0,i=i.concat(o.makeLines(a,"left")),a=0,a+=e(n+1,r-1)?4:0,a+=e(n+1,r)?2:0,a+=e(n+1,r+1)?1:0,i=i.concat(o.makeLines(a,"right"));var c=[];return _.each(i,function(t){c.push(o.createLine({a:[n+t.a[0],r+t.a[1]],b:[n+t.b[0],r+t.b[1]]}))}),c},getCell:function(t,n){return e(t,n)},addBlocks:function(n){t=n}}}},{"./line":7}],9:[function(t,n,e){"use strict";var o=new THREE.Matrix3,r=new THREE.Vector3,i=function(t){var n=t.x+t.x,e=t.y+t.y,r=t.z+t.z,i=n*t.w,a=e*t.w,c=r*t.w,u=n*t.x,s=e*t.x,f=r*t.x,l=e*t.y,p=r*t.y,d=r*t.z;return o.set(1-(l+d),s-c,0,s+c,1-(u+d),0,f-a,p+i,0)};n.exports=function(t,n,e){r.copy(e),r.applyMatrix3(i(n)),t.x+=r.x,t.y+=r.y}},{}],10:[function(t,n,e){const o=5,r=3*(Math.PI/180),i=new THREE.Vector3(0,5,0);var a=[{x:0,y:.175,z:0,r:.25},{x:0,y:-.175,z:0,r:.25}];n.exports=function(n){"use strict";var e=t("./physics/entity")(),c=t("./physics/thrust"),u=!1,s=!1,f=!1;e.forces=function(t,n){u?t.z+=r:s&&(t.z-=r);var e=new THREE.Quaternion;e.setFromEuler(t),c(n,e,i)},e.control=function(t,n,e){u&&(e.z+=r),s&&(e.z-=r)},e.limitVelocity=function(t){t.length()>o&&(t.normalize(),t.multiplyScalar(o))};var l=function(t,n){u=n.left,s=n.right,f=n.jump};return $(n.input).on("input.move",l),{position:e.position,rotation:e.rotation,detatchInput:function(){$(n.input).off("input.move",l)},reset:function(){f=u=s=!1,e.setPosition(n.pos.x,n.pos.y)},update:function(t,o,r){n.input.update(t),e.update(o,a,r)}}}},{"./physics/entity":6,"./physics/thrust":9}],11:[function(t,n,e){var o=26;n.exports=function(t){"use strict";var n,e=new THREE.Scene,r=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,o-9,o),i=new THREE.AmbientLight(16777215),a=new THREE.WebGLRenderer;return r.position.set(0,0,o),r.updateProjectionMatrix(),e.add(r),e.add(i),a.setSize(window.innerWidth,window.innerHeight),a.setClearColor(4079166,1),$("body").append(a.domElement),n={render:function(){a.render(e,r)},add:function(t){e.add(t)},follow:function(t){r.position.set(t.x,t.y,o)},remove:function(t){e.remove(t)},clear:function(){var t=_.clone(e.children);_.each(t,function(t){e.remove(t)})}}}},{}],12:[function(t,n,e){n.exports=function(){"use strict";var n,e=t("./assets"),o=t("./scene"),r=t("./physics/map"),i=[],a=[],c=r(),u={tw:64,th:48},s=o($("#canvas"));return{update:function(t,n){_.each(i,function(e){e.update(t,n,c.getLines(e))})},render:function(t){_.each(i,function(t){t.avatar.rotation.x=t.avatar.rotation.y=t.avatar.rotation.z=0,t.avatar.rotation.z=t.rotation().z,t.avatar.position.copy(t.position())}),n&&s.follow(n.position),s.render()},clear:function(){i=[],a=[],c.clear(),s.clear()},addTarget:function(t){var n=e.cubeTarget();a.push(t),t.avatar=n,n.position.set(t.x,t.y,0),s.add(n)},addPlayer:function(t,o){i.push(t),t.avatar=e.cubePlayer(),s.add(t.avatar),o&&(n=t.avatar)},addBlocks:function(t){c.addBlocks(t);var n,o,r,i;for(o=u.th-1;o>=0;o--)for(n=0;n<u.tw;n++)r=c.getCell(n,o),i=1===r?e.cubeSolid():e.cubeEmpty(),i.position.set(n,o,0),s.add(i)},isComplete:function(){return a.length<=0}}}()},{"./assets":2,"./physics/map":8,"./scene":11}]},{},[1]);