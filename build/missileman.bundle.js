!function t(n,e,o){function r(a,c){if(!e[a]){if(!n[a]){var u="function"==typeof require&&require;if(!c&&u)return u(a,!0);if(i)return i(a,!0);var s=new Error("Cannot find module '"+a+"'");throw s.code="MODULE_NOT_FOUND",s}var f=e[a]={exports:{}};n[a][0].call(f.exports,function(t){var e=n[a][1][t];return r(e?e:t)},f,f.exports,t,n,e,o)}return e[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(t,n,e){!function(){"use strict";const n="level.json",e=t("./src/event"),o=t("./src/overlay"),r=t("./src/input"),i=t("./src/player"),a=t("./src/assets"),c=t("./src/world"),u=t("./src/loop");var s=[],f=[],l=0,p=r({keys:{left:37,right:39,jump:38}}),d=r({keys:{up:38,down:40,select:13}});const y=function(t){f=t.spawnPoints,_.each(t.targets,function(t){c.addTarget(t)}),c.addBlocks(t.cells)},h=function(t){const n=function(n){$.get(t,function(t){y(t.cells?t:JSON.parse(t)),n()})},e=function(){0===s.length&&(s[l]=i({input:p,pos:f[l]})),p.reset(),_.each(s,function(t){t.reset(),c.addPlayer(t,t===s[l])})};c.clear(),u.reset(),n(e)};$(c).on("world.player.killed",function(t,e){s[l]===e&&(s[l].detatchInput(),s[l]=i({input:r({replay:p.serialize()}),obj:f[l]}),l+=1,l>=f.length&&(l=0),s[l]&&s[l].detatchInput(),s[l]=i({input:p,obj:f[l]}),setTimeout(function(){c.isComplete()?o.showTitle(d):(o.fadeFromBlack(),h(n))},1e3))}),$(o).on("title.playbutton.click",function(){o.hideTitle(),o.fadeFromBlack(),_.each(s,function(t){t.detatchInput()}),s=[],l=0,h(n)}),$(document).ready(function(){a.load(),$(a).on("assets.loaded",function(){o.fadeFromBlack(),o.showTitle(d)})}),e(u).on("loop.update",function(t,n){d.update(t),c.update(t,n)}),e(u).on("loop.render",function(t){c.render(t)})}()},{"./src/assets":2,"./src/event":3,"./src/input":4,"./src/loop":5,"./src/overlay":6,"./src/player":11,"./src/world":13}],2:[function(t,n,e){"use strict";n.exports=function(){var t={};const n=function(t){var n=new THREE.BoxGeometry(1,1,1),e=new THREE.MeshBasicMaterial({color:t}),o=new THREE.Mesh(n,e);return o};return{load:function(){var n=new THREE.LoadingManager,e=new THREE.JSONLoader(n),o=function(n,o,r){e.load("assets/"+o+".json",function(e){t[n]=new THREE.Mesh(e,void 0===r?new THREE.MeshDepthMaterial:new THREE.MeshBasicMaterial({color:r}))})},r=this;n.onLoad=function(){$(r).trigger("assets.loaded")},o("empty","empty"),o("solid","solid"),o("player","player",96725)},cubeEmpty:function(n){return t.empty.clone()},cubeSolid:function(){return t.solid.clone()},cubeTarget:function(){return n(11289666)},cubePlayer:function(){return t.player.clone()}}}()},{}],3:[function(t,n,e){n.exports=function(){"use strict";var t=[];return function(n){var e=_.find(t,function(t){return t.a===n});return _.isUndefined(e)&&(e={a:n},+function(){var t={};e.off=function(n,e){t=_.without(t,e)},e.on=function(n,e){_.isUndefined(t[n])&&(t[n]=[]),t[n].push(e)},e.trigger=function(n,o){var r=t[n];_.isObject(r)&&_.each(r,function(t){t.apply(e,o||[])})}}(),t.push(e)),e}}()},{}],4:[function(t,n,e){"use strict";const o=function(t){var n=JSON.parse(t);return{update:function(t){var e=n["_"+t];e&&$(this).trigger("input.move",_.clone(e))}}},r=function(t){var n=_.mapObject(t,function(){return!1}),e=_.clone(n),o={};const r=function(e,o,r){_.findKey(t,function(t,i){return t===o?(n[i]=r,e.preventDefault(),!0):void 0})};return $(document).keydown(function(t){return r(t,t.keyCode,!0)}),$(document).keyup(function(t){return r(t,t.keyCode,!1)}),{reset:function(){o={}},serialize:function(){return JSON.stringify(o)},update:function(t){_.isMatch(n,e)||(o["_"+t]=_.clone(n),$(this).trigger("input.move",_.clone(n)),_.extend(e,n))}}};n.exports=function(t){return t.replay?o(t.replay):r(t.keys)}},{}],5:[function(t,n,e){n.exports=function(){"use strict";const n=t("./event"),e=function(){var t={begin:function(){},end:function(){}};return"undefined"!=typeof Stats&&(t=new Stats,t.setMode(0),t.domElement.style.position="absolute",t.domElement.style.left="0px",t.domElement.style.top="0px",$("body").append(t.domElement)),t}(),o=function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()};var r,i,a=1/60,c=0,u=o(),s=0;return+function f(){for(requestAnimationFrame(f),e.begin(),i=o(),c+=Math.min(1,(i-u)/1e3);c>a;)c-=a,n(r).trigger("loop.update",[s,a]),s+=1;n(r).trigger("loop.render",[c]),u=i,e.end()}(),r={reset:function(){s=0}}}()},{"./event":3}],6:[function(t,n,e){n.exports=function(){"use strict";var t,n,e=function(){var t=$("<div/>").css({position:"fixed",backgroundColor:"black",height:"100%",width:"100%",margin:0,padding:0});return $("body").append(t),t}(),o=function(){var n=$("<button>").css({position:"fixed",bottom:"-100px",left:"50%"}).click(function(){$(t).trigger("title.playbutton.click")}).text("Play");return $("body").append(n),n}(),r=function(n,e){e.select&&$(t).trigger("title.playbutton.click")};return t={fadeFromBlack:function(){e.css({opacity:1}),e.stop().animate({opacity:0},600)},showTitle:function(t){o.stop().animate({bottom:"100px"},600,"easeOutBack"),n=t,$(n).on("input.move",r)},hideTitle:function(){o.stop().animate({bottom:"-100px"},400,"easeInBack"),$(n).off("input.move",r)}}}()},{}],7:[function(t,n,e){n.exports=function(){"use strict";var t=new THREE.Euler,n=new THREE.Vector2(0,0),e=new THREE.Vector2(0,0);const o=function(){var t,o,r,i=new THREE.Vector2;return function(a,c){i.copy(a).sub(c),r=i.lengthSq(),r<a.rs&&(t=a.r-Math.sqrt(r),o=i.normalize().multiplyScalar(t),e.add(o),n.sub(o))}}(),r=function(n,r){var i=new THREE.Vector3,a=new THREE.Matrix4;return function(n,r){i.set(e.x,e.y,0),a.makeRotationFromEuler(t).setPosition(i),_.each(r,function(t){_.each(n,function(n){i.set(n.x,n.y,0).applyMatrix4(a),i.r=n.r,i.rs=n.rs,o(i,t.nearestPoint(i))})})}}(),i=function(){var o=new THREE.Vector2;return function(i,c,u){o.set(0,0),a.forces(t,o),o.multiplyScalar(i),n.add(o),a.limitVelocity(n),o.copy(n).multiplyScalar(i),e.add(o),u.length>0&&r(c,u)}}();var a={update:function(t,n,e){i(t,n,e)},forces:function(t,n){},limitVelocity:function(t){},setPosition:function(t,n){e.set(t,n,0)},position:function(){var t=new THREE.Vector3;return function(){return t.set(e.x,e.y,0)}}(),rotation:function(){var n=new THREE.Euler;return function(){return n.copy(t)}}()};return a}},{}],8:[function(t,n,e){var o=[];o.push([[],[{a:[1,1],b:[2,1]}],[{a:[0,1],b:[1,1]}],[{a:[0,1],b:[2,1]}],[{a:[-1,1],b:[0,1]}],[{a:[-1,1],b:[0,1]},{a:[1,1],b:[2,1]}],[{a:[-1,1],b:[1,1]}],[{a:[-1,1],b:[2,1]}]]),o.push([[],[{a:[1,0],b:[2,0]}],[{a:[0,0],b:[1,0]}],[{a:[0,0],b:[2,0]}],[{a:[-1,0],b:[0,0]}],[{a:[-1,0],b:[0,0]},{a:[1,0],b:[2,0]}],[{a:[-1,0],b:[1,0]}],[{a:[-1,0],b:[2,0]}]]),o.push([[],[{a:[0,1],b:[0,2]}],[{a:[0,0],b:[0,1]}],[{a:[0,0],b:[0,2]}],[{a:[0,-1],b:[0,0]}],[{a:[0,-1],b:[0,0]},{a:[0,1],b:[0,2]}],[{a:[0,-1],b:[0,1]}],[{a:[0,-1],b:[0,2]}]]),o.push([[],[{a:[1,1],b:[1,2]}],[{a:[1,0],b:[1,1]}],[{a:[1,0],b:[1,2]}],[{a:[1,-1],b:[1,0]}],[{a:[1,-1],b:[1,0]},{a:[1,1],b:[1,2]}],[{a:[1,-1],b:[1,1]}],[{a:[1,-1],b:[1,2]}]]),n.exports={createLine:function(t){var n={x:t.a[0],y:t.a[1],z:0},e={x:t.b[0],y:t.b[1],z:0},o=function(){var t=new THREE.Vector2;return t.subVectors(e,n)}(),r=function(){return o.lengthSq()}();return{p1:n,p2:e,nearestPoint:function(){var t=new THREE.Vector2,i=t.clone();return function(a){var c=t.subVectors(i.copy(a),n).dot(o);return 0>c?n:c>r?e:t.copy(o).multiplyScalar(c/r).add(n)}}()}},makeLines:function(t,n){switch(n){case"top":return o[0][t];case"bottom":return o[1][t];case"left":return o[2][t];case"right":return o[3][t]}return[]}}},{}],9:[function(t,n,e){var o=t("./line");n.exports=function(){"use strict";var t=[],n={tw:64,th:48},e=function(e,o){return t[e+o*n.tw]};return{clear:function(){t=[]},getLines:function(t){var n=Math.floor(t.position().x),r=Math.floor(t.position().y),i=[],a=0;a+=e(n-1,r-1)?4:0,a+=e(n,r-1)?2:0,a+=e(n+1,r-1)?1:0,i=i.concat(o.makeLines(a,"bottom")),a=0,a+=e(n-1,r+1)?4:0,a+=e(n,r+1)?2:0,a+=e(n+1,r+1)?1:0,i=i.concat(o.makeLines(a,"top")),a=0,a+=e(n-1,r-1)?4:0,a+=e(n-1,r)?2:0,a+=e(n-1,r+1)?1:0,i=i.concat(o.makeLines(a,"left")),a=0,a+=e(n+1,r-1)?4:0,a+=e(n+1,r)?2:0,a+=e(n+1,r+1)?1:0,i=i.concat(o.makeLines(a,"right"));var c=[];return _.each(i,function(t){c.push(o.createLine({a:[n+t.a[0],r+t.a[1]],b:[n+t.b[0],r+t.b[1]]}))}),c},getCell:function(t,n){return e(t,n)},addBlocks:function(n){t=n}}}},{"./line":8}],10:[function(t,n,e){"use strict";var o=new THREE.Matrix3,r=new THREE.Vector3;const i=function(t){var n=t.x+t.x,e=t.y+t.y,r=t.z+t.z,i=n*t.w,a=e*t.w,c=r*t.w,u=n*t.x,s=e*t.x,f=r*t.x,l=e*t.y,p=r*t.y,d=r*t.z;return o.set(1-(l+d),s-c,0,s+c,1-(u+d),0,f-a,p+i,0)};n.exports=function(t,n,e){r.copy(e),r.applyMatrix3(i(n)),t.x+=r.x,t.y+=r.y}},{}],11:[function(t,n,e){const o=5,r=3*(Math.PI/180),i=(new THREE.Vector3(0,5,0),.25),a=[{x:0,y:.175,z:0,r:i,rs:.0625},{x:0,y:-.175,z:0,r:i,rs:.0625}];n.exports=function(n){"use strict";const e=t("./physics/entity")();t("./physics/thrust");var i=!1,c=!1,u=!1;e.forces=function(t,n){i?n.x-=3:c&&(n.x+=3),n.y-=5},e.control=function(t,n,e){i&&(e.z+=r),c&&(e.z-=r)},e.limitVelocity=function(t){t.length()>o&&(t.normalize(),t.multiplyScalar(o))};const s=function(t,n){i=n.left,c=n.right,u=n.jump};return $(n.input).on("input.move",s),{position:e.position,rotation:e.rotation,detatchInput:function(){$(n.input).off("input.move",s)},reset:function(){u=i=c=!1,e.setPosition(n.pos.x,n.pos.y)},update:function(t,o,r){n.input.update(t),e.update(o,a,r)}}}},{"./physics/entity":7,"./physics/thrust":10}],12:[function(t,n,e){var o=26;n.exports=function(t){"use strict";var n,e=new THREE.Scene,r=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,o-9,o),i=new THREE.AmbientLight(16777215),a=new THREE.WebGLRenderer;return r.position.set(0,0,o),r.updateProjectionMatrix(),e.add(r),e.add(i),a.setSize(window.innerWidth,window.innerHeight),a.setClearColor(4079166,1),$("body").append(a.domElement),n={render:function(){a.render(e,r)},add:function(t){e.add(t)},follow:function(t){r.position.set(t.x,t.y,o)},remove:function(t){e.remove(t)},clear:function(){var t=_.clone(e.children);_.each(t,function(t){e.remove(t)})}}}},{}],13:[function(t,n,e){n.exports=function(){"use strict";const n=t("./assets"),e=t("./scene"),o=t("./physics/map");var r,i=[],a=[],c=o(),u={tw:64,th:48},s=e($("#canvas"));return{update:function(t,n){_.each(i,function(e){e.update(t,n,c.getLines(e))})},render:function(t){_.each(i,function(t){t.avatar.rotation.x=t.avatar.rotation.y=t.avatar.rotation.z=0,t.avatar.rotation.z=t.rotation().z,t.avatar.position.copy(t.position())}),r&&s.follow(r.position),s.render()},clear:function(){i=[],a=[],c.clear(),s.clear()},addTarget:function(t){var e=n.cubeTarget();a.push(t),t.avatar=e,e.position.set(t.x,t.y,0),s.add(e)},addPlayer:function(t,e){i.push(t),t.avatar=n.cubePlayer(),s.add(t.avatar),e&&(r=t.avatar)},addBlocks:function(t){c.addBlocks(t);var e,o,r,i;for(o=u.th-1;o>=0;o--)for(e=0;e<u.tw;e++)r=c.getCell(e,o),i=1===r?n.cubeSolid():n.cubeEmpty(),i.position.set(e,o,0),s.add(i)},isComplete:function(){return a.length<=0}}}()},{"./assets":2,"./physics/map":9,"./scene":12}]},{},[1]);